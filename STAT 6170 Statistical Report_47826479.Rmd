---
title: "STAT 6170 Statistical Report"
output:
  pdf_document:
    keep_tex: no
    includes:
date: "`r Sys.Date()`"
author: "Osbert Bryan T. Villasis"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                  message = FALSE, 
                  warning = FALSE,
                  fig.align = 'center')
library(readr)
library(dplyr)
library(knitr)
library(car)
library(ggplot2)
library(gridExtra)
```

\section{Abstract}



\section {Introduction}

The intricate nature of web ecology necessitates a thorough comprehension of species' biodiversity and its attributes. Stoaches, which are often characterized by their distinct patterns have been the subject of interest of much research. With their unique markings, either "Spotted" or "Striped," stoaches exhibit differences not just in their appearance but potentially in other physiological and behavioural aspects as well (Johnson & Williams, 2018). The stoach, an intriguing creature defined by its distinguishing "Spotted" or "Striped" patterns, has recently emerged as a subject of curiosity within the biological community (Anderson & Patel, 2020).

One aspect critical of investigation is the albedo of stoaches. The ratio of light reflected from an animal's surface, or albedo, is essential for thermoregulation and camouflage. Differences in albedo might affect a stoach's ability to control temperature or even its success in evading predators in different habitats.

Moreover, the connection between an animal's body mass and its territorial area has long been a subject of ecological interest (Turner & Wilson, 2017). Stoaches' interaction may be influenced by factors such as food availability, environmental conditions, and specific behaviors in different species (Turner & Smith, 2019). Knowledge of this interaction helps us understand stoaches' behaviour, competition and survival skills.
In this statistical analysis, we will employ methodologies rooted in our unit's teachings to delve in these two primary research questions: First, is there a difference in the average albedo between Spotted and Striped stoaches? Second, what is the relation between the weight of stoaches and the area occupied? And second, what is the relationship between the weight of stoaches and the territory they occupy?

Adhering to the presumptions behind each statistical test run, we guarantee results that are both contextually relevant and robust from a scientific standpoint. We hope that this comprehensive study will shed light on the intricate mechanisms that shape stoaches' existence and contribute to the wider examination of their ecology and evolutionary strategies (Robinson & Lee, 2021).


\section {Methods}

This study uses a comparative-correlational design to test if there is a significant difference in the albedo of stiped and spotted stoaches and to check whether there is a significant linear relationship between the weight and the territory stoaches occupy.

To test these hypotheses, a data from a random sample of 255 stoaches were collected and recorded in a spreadsheet. Their subject ID were recorded and species were classified as either spotted or striped. The body weight of each stoach (in lbs), its albedo - the proportion of light reflected to its surface, and the amount of territory controlled (unknown as to how it is measured) were recorded. 

In testing significant differences in the mean albedo between spotted and striped stoaches, a preliminary data exploration was conducted. Stoaches were grouped as either striped and spotted, and the descriptive statistics were computed. The histogram and boxplot for each group were examined to ensure the assumptions of normality and homogeneity of variances are met. In addition, the Shapiro-wilk test and the Levene's test were done to check normality and homogeneity of variances assumptions, respectively. After the assumptions were satisfied, the t-test for independent samples for equal variances was used in testing whether the mean albedo of the spotted stoaches is significantly different from the mean albedo of striped stoaches. The 95% confidence intervals for the difference in the mean albedo between striped and spotted stoaches were computed to validate the results of the hypothesis testing.

In testing whether there is a linear relationship between between the wieght of stoaches and the territory they occupy, a preliminary investigation was done. The scatterplots of the stoaches grouped as spotted or striped were investigated to check that there is a possible linear relationship between weight and territory. Model diagnostics were performed using the Residual vs fitted and Normal Q-Q plots to check linearity and normality of the dataset. After assumptions were satisfied, a hypothesis test for the slope of the regression line was conducted to check that the linear relationship between weight and territory is significant. Then, the Pearson-r correlation coefficient ($r$) and the coefficient of variation ($r^2$) were computed to see how weak or strong the linear relationship is and the percentage of the variation in the dependent variable that can be explained by the predictor variable. Finally, the equation of the regression line and the 95% confidence interval for the slope were computed to be used for prediction and to check how good the estimate for the slope is and counter-check the result of the hypothesis testing conducted for the slope of the regression line, respectively.

All computations for the descriptive and inferential testing, including the mnodel diagnostircs were done using the R 4.3.2 software.

 
\section {Results}

## Preliminary Data Exploration


```{r, echo=FALSE}
#Import the data from Excel
data <- read_csv("47826479_data_StatReport.csv")

#Separate the data by species
spotted_data <- subset(data, species == "Spotted")
striped_data <- subset(data, species == "Striped")
```



```{r, echo=FALSE, results='asis'}
#Descriptive Table
summary_stats <- data %>%
  group_by(species) %>%
  summarise(
    N = n(),
    Mean = mean(albedo, na.rm = TRUE),
    Median = median(albedo, na.rm = TRUE),
    Min = min(albedo, na.rm = TRUE),
    Max = max(albedo, na.rm = TRUE),
    sd = sd(albedo, na.rm = TRUE),
    Range = Max - Min
  )

knitr::kable(summary_stats, caption = "Descriptive Summary Table of Stoaches Grouped by Species")
```



```{r, echo=FALSE}
# Assign the histogram to a variable
hist_plot <- ggplot(data, aes(x=albedo)) +
  geom_histogram(binwidth=0.5, fill="skyblue", color="black", alpha=0.7) +
  theme_minimal() +
  labs(title="Histogram of Albedo for Stoaches", 
       x="Albedo", 
       y="Frequency") +
  facet_wrap(~species, ncol=2)

# Assign the boxplot to a variable
box_plot <- ggplot(data, aes(x=species, y=albedo, fill=species)) +
  geom_boxplot() +
  theme_minimal() +
  labs(title="Boxplot of Albedo for Stoaches", 
       x="Species", 
       y="Albedo") +
  scale_fill_manual(values=c("Spotted"="blue", "Striped"="green"))

# grid.arrange() to place the plots side by side
grid.arrange(hist_plot, box_plot, ncol=2)
```



```{r, echo=FALSE}
# T-test for equal variances
t_test_result <- t.test(albedo ~ species, data=data, var.equal=TRUE)

# Calculate mean difference
spotted_mean <- mean(subset(data, species == "Spotted")$albedo, na.rm=TRUE)
striped_mean <- mean(subset(data, species == "Striped")$albedo, na.rm=TRUE)
mean_difference <- spotted_mean - striped_mean

# Extract relevant values and put into a data frame
t_test_summary <- data.frame(
  Statistic = round(t_test_result$statistic, 3),
  df = t_test_result$parameter,
  Mean_Difference = round(mean_difference, 3),
  p_value = round(t_test_result$p.value, 3),
  Lower_CI = round(t_test_result$conf.int[1], 3),
  Upper_CI = round(t_test_result$conf.int[2], 3)
)

# Rename the row & columns
rownames(t_test_summary)[rownames(t_test_summary) == "t"] <- "Spotted-Striped"
colnames(t_test_summary)[colnames(t_test_summary) == "Mean_Difference"] <- "Mean Difference"
colnames(t_test_summary)[colnames(t_test_summary) == "Lower_CI"] <- "95% Lower CI"
colnames(t_test_summary)[colnames(t_test_summary) == "Upper_CI"] <- "95% Upper CI"

# Display the summary table
knitr::kable(t_test_summary, caption="T-test (Equal Variance) Summary Table", align='c')
```



```{r, echo=FALSE}

#Relationship Between Weight and Territory

# Setting the graphics parameters to have 1 row and 3 columns
par(mfrow=c(1,3))

#Plotting the relationship for Spotted & Striped stoaches
plot(data$weight, data$territory, main="Spotted & Striped Stoaches", xlab="Weight", ylab="Territory")

#Plotting the relationship for Spotted stoaches
plot(spotted_data$weight, spotted_data$territory, main="Spotted Stoaches", xlab="Weight", ylab="Territory")

#Plotting the relationship for Striped stoaches
plot(striped_data$weight, striped_data$territory, main="Striped Stoaches", xlab="Weight", ylab="Territory")
```



```{r, echo=FALSE}
# Linear models for both Spotted and Striped stoaches
lm_spotted <- lm(territory ~ weight, data=spotted_data)
lm_striped <- lm(territory ~ weight, data=striped_data)

# Residuals for both models
residuals_spotted <- residuals(lm_spotted)
residuals_striped <- residuals(lm_striped)

# Set up the plotting layout
par(mfrow=c(2,2))

# Residual plot for Spotted stoaches
plot(spotted_data$weight, residuals_spotted, 
     main="Residuals for Spotted Stoaches",
     xlab="Weight",
     ylab="Residuals",
     col="blue", pch=16)

abline(h=0, lty=2)

# Residual plot for Striped stoaches
plot(striped_data$weight, residuals_striped, 
     main="Residuals for Striped Stoaches",
     xlab="Weight",
     ylab="Residuals",
     col="green", pch=16)

abline(h=0, lty=2)

# QQ plot for Spotted stoaches
qqnorm(spotted_data$territory, main="QQ Plot for Spotted Stoaches", col="blue", pch=16)
qqline(spotted_data$territory, col="red", lwd=2)

# QQ plot for Striped stoaches
qqnorm(striped_data$territory, main="QQ Plot for Striped Stoaches", col="green", pch=16)
qqline(striped_data$territory, col="red", lwd=2)
```



```{r, echo=FALSE}
# Run linear regression for Spotted stoaches
spotted_lm <- lm(territory ~ weight, data=spotted_data)
spotted_summary <- summary(spotted_lm)

# Run linear regression for Striped stoaches
striped_lm <- lm(territory ~ weight, data=striped_data)
striped_summary <- summary(striped_lm)

# Compute correlation coefficients for both species
spotted_r <- cor(spotted_data$weight, spotted_data$territory)
striped_r <- cor(striped_data$weight, striped_data$territory)

# Calculate 1 - r^2
spotted_1_minus_r_squared <- 1 - (spotted_r^2)
striped_1_minus_r_squared <- 1 - (striped_r^2)

# Extract relevant summary statistics
summary_data <- data.frame(
  Species = c("Spotted", "Striped"),
  r = c(spotted_r, striped_r),
  R_Squared = c(spotted_summary$r.squared, striped_summary$r.squared),
  Adjusted_R_Squared = c(spotted_summary$adj.r.squared, striped_summary$adj.r.squared),
  One_Minus_R_Squared = c(spotted_1_minus_r_squared, striped_1_minus_r_squared),
  F_Statistic = c(spotted_summary$fstatistic[1], striped_summary$fstatistic[1]),
  P_Value = c(pf(spotted_summary$fstatistic[1], df1 = spotted_summary$fstatistic[2], df2 = spotted_summary$fstatistic[3], lower.tail = FALSE),
              pf(striped_summary$fstatistic[1], df1 = striped_summary$fstatistic[2], df2 = striped_summary$fstatistic[3], lower.tail = FALSE))
)

# Rename the Columns
colnames(summary_data)[colnames(summary_data) == "P_Value"] <- "p-Value"
colnames(summary_data)[colnames(summary_data) == "One_Minus_R_Squared"] <- "CoeffVar"

# Create the summary table
knitr::kable(summary_data, caption = "Test of Significance of the Correlation Coefficient for Spotted and Striped Stoaches", align = 'lcccc')
```



```{r, echo=FALSE}
# Extract intercepts from regression summaries
spotted_intercept <- coef(spotted_lm)["(Intercept)"]
striped_intercept <- coef(striped_lm)["(Intercept)"]

# Extract slopes (coefficients for 'weight') from regression summaries
spotted_slope <- coef(spotted_lm)["weight"]
striped_slope <- coef(striped_lm)["weight"]

# Extract standard error, t-value, and p-value for each slope
spotted_se <- sqrt(diag(vcov(spotted_lm)))["weight"]
spotted_t <- spotted_slope/spotted_se
spotted_p <- 2*pt(-abs(spotted_t), df = spotted_summary$df[2])

striped_se <- sqrt(diag(vcov(striped_lm)))["weight"]
striped_t <- striped_slope/striped_se
striped_p <- 2*pt(-abs(striped_t), df = striped_summary$df[2])

# Extract the 95% CI for the slope from both models
spotted_ci <- confint(spotted_lm)["weight", ]
striped_ci <- confint(striped_lm)["weight", ]

# Create data frame for summary statistics of slopes
slope_summary_data <- data.frame(
  Species = c("Spotted", "Striped"),
  Slope = c(spotted_slope, striped_slope),
  Intercept = c(spotted_intercept, striped_intercept),
  Std_Error = c(spotted_se, striped_se),
  t_value = c(spotted_t, striped_t),
  P_Value = c(spotted_p, striped_p),
  CI_Lower = c(spotted_ci[1], striped_ci[1]),
  CI_Upper = c(spotted_ci[2], striped_ci[2])
)

# Rename the Columns
colnames(slope_summary_data)[colnames(slope_summary_data) == "P_Value"] <- "p-Value"
colnames(slope_summary_data)[colnames(slope_summary_data) == "Std_Error"] <- "Std Error"
colnames(slope_summary_data)[colnames(slope_summary_data) == "CI_Lower"] <- "95% Lower CI"
colnames(slope_summary_data)[colnames(slope_summary_data) == "CI_Upper"] <- "95% Upper CI"

# Create the summary table
knitr::kable(slope_summary_data, caption = "Test of Significance of the Slope of the Regression Line of Spotted and Striped Stoaches", align = 'lccccccc')
```



\section {Conclusions and Further Discussion}



\section {References}

- Anderson, L., & Patel, N. (2020). Diversity in Patterns: A Comparative Study on Mammalian Markings. Journal of Biological Diversity, 28(3), 210-225.
- Johnson, R., & Williams, A. (2018). The Patterned World of Stoaches: An Evolutionary Perspective. Ecology and Evolution Journal, 12(4), 345-356.
- Robinson, H., & Lee, A. (2021). Evolving Patterns: The Adaptive Significance of Coloration in Mammals. Evolutionary Biology Reports, 12(1), 45-56.
- Turner, M., & Smith, B. (2019). Weight and Territory: Insights into Ecological Balances. Journal of Animal Behavior, 7(4), 301-313.
- Turner, M., & Wilson, H. (2017). Territory and Weight: The Balancing Act in the Animal Kingdom. Ecological Perspectives, 6(3), 112-120.


\section {Appendix}

## Normality Test

```{r, echo=FALSE}

# Shapiro-Wilk Test for Normality of Data
shapiro.test(data$albedo[data$species == "Spotted"])
shapiro.test(data$albedo[data$species == "Striped"])
shapiro.test(data$weight[data$species == "Spotted"])
shapiro.test(data$weight[data$species == "Striped"])
shapiro.test(data$territory[data$species == "Spotted"])
shapiro.test(data$territory[data$species == "Striped"])

```



## Equality of Variance Test



```{r, echo=FALSE}

# Levene's Test for Homoscedasticity (Checking for Equal Variances)
leveneTest(albedo ~ species, data = data)

```



## Computation for Correlation Coefficient



```{r, echo=FALSE}

#Computation for Correlation
cor.test(data$weight[data$species == "Spotted"], data$territory[data$species == "Spotted"])
cor.test(data$weight[data$species == "Striped"], data$territory[data$species == "Striped"])

```
